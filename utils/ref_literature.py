import numpy as np


class REFERENCE(object):
    def __init__(self, res=250):
        self.beta_energy = [
            19.5181, 19.6875, 19.831, 19.9724, 20.0541, 20.1458, 20.2454, 20.3371,
            20.4567, 20.5404, 20.64, 20.6779, 20.7237, 20.7556, 20.7915, 20.8193,
            20.8572, 20.8871, 20.9169, 20.9388, 20.9608, 20.9867, 21.0166, 21.0584,
            21.0883, 21.1103, 21.1262, 21.1462, 21.1741, 21.194, 21.216, 21.2458,
            21.2658, 21.2717, 21.2757, 21.2895, 21.3686, 21.4345, 21.4662, 21.4834,
            21.4993, 21.5132, 21.5311, 21.559, 21.5889, 21.6108, 21.6308, 21.6548,
            21.7288, 21.7768, 21.7989, 21.8469, 21.8849, 21.9149, 21.9728, 22.0267,
            22.1046, 22.1644, 22.2382, 22.2901, 22.3121, 22.34, 22.3838, 22.7206,
            22.7704, 22.8023, 22.8382, 22.892, 22.9776, 23.0414, 23.1072, 23.2347,
            23.3523, 23.4818, 23.5934, 23.689, 23.7906, 23.8723, 23.934, 23.9997
        ]

        self.delta_real_energy = [
            19.4969, 19.5407, 19.6064, 19.6622, 19.7061, 19.7519, 19.9313, 20.1126,
            20.1724, 20.2581, 20.3697, 20.4733, 20.5649, 20.6546, 20.7084, 20.7582,
            20.7921, 20.8279, 20.8558, 20.8778, 20.9276, 20.9794, 21.0292, 21.073,
            21.1109, 21.1467, 21.1686, 21.1865, 21.2025, 21.2203, 21.2382, 21.2541,
            21.268, 21.2839, 21.2998, 21.3197, 21.3456, 21.3716, 21.4074, 21.4234,
            21.4514, 21.4874, 21.5074, 21.5314, 21.5535, 21.5934, 21.6374, 21.6793,
            21.7173, 21.7512, 21.7851, 21.819, 21.8509, 21.8967, 21.9366, 22.0043,
            22.0621, 22.1537, 22.2872, 22.3828, 22.4684, 22.5441, 22.6158, 22.6656,
            22.7493, 22.849, 23.0422, 23.4388, 23.5942, 23.7337, 23.8472, 23.913,
            23.9529, 23.9947
        ]

        self.real_part = [
            1.10402, 1.11182, 1.11964, 1.12226, 1.12488, 1.1262, 1.12629, 1.12769,
            1.12901, 1.13295, 1.1382, 1.14473, 1.15256, 1.16299, 1.17469, 1.19287,
            1.20327, 1.21107, 1.20978, 1.2072, 1.20723, 1.21114, 1.21766, 1.22935,
            1.24494, 1.26311, 1.27998, 1.29815, 1.31762, 1.34875, 1.39935, 1.45124,
            1.48496, 1.5161, 1.53557, 1.55373, 1.56023, 1.55376, 1.53303, 1.50969,
            1.44485, 1.34241, 1.27368, 1.1829, 1.10379, 0.996158, 0.895014, 0.818511,
            0.760165, 0.722569, 0.697943, 0.684991, 0.678522, 0.679843, 0.683755,
            0.69676, 0.713651, 0.751312, 0.816233, 0.857787, 0.890257, 0.914939,
            0.934432, 0.943537, 0.952659, 0.960493, 0.980048, 1.02435, 1.04389,
            1.05563, 1.05829, 1.05443, 1.05056, 1.0415
        ]

        self.betas = [
            0.00078444, 0.0118746, 0.0197092, 0.0275432, 0.0301635, 0.0321367,
            0.0328123, 0.0308869, 0.0276691, 0.024442, 0.0244679, 0.0251275, 0.0257892,
            0.0296961, 0.0388022, 0.0466067, 0.0563632, 0.0628687, 0.0687244,
            0.0706794, 0.0713349, 0.0700421, 0.0674507, 0.0622634, 0.0616214,
            0.0616271, 0.0577326, 0.0492908, 0.0356528, 0.0304598, 0.0278664,
            0.0304733, 0.0369762, 0.0434755, 0.0551724, 0.0987108, 0.365571, 0.555322,
            0.641101, 0.678359, 0.702404, 0.716703, 0.723855, 0.725812, 0.722571,
            0.714129, 0.69789, 0.662159, 0.551067, 0.470508, 0.430877, 0.342521,
            0.288599, 0.254169, 0.196354, 0.154783, 0.10542, 0.0722975, 0.039828,
            0.018399, 0.00995765, 0.00216764, 0.000229712, 0.000317246, 0.00747769,
            0.0126842, 0.0133433, 0.0133572, 0.0127297, 0.0133961, 0.014063, 0.017345,
            0.0212742, 0.0291051, 0.0382309, 0.0506015, 0.067522, 0.0844373, 0.0980986,
            0.111111
        ]

        common_min = np.max([np.min(self.beta_energy), np.min(self.delta_real_energy)])
        common_max = np.min([np.max(self.beta_energy), np.max(self.delta_real_energy)])
        self.e_ev = np.linspace(common_min, common_max, res)
        deltas = 1 - np.array(self.real_part)
        self.beta = np.interp(self.e_ev, self.beta_energy, self.betas)
        self.real = np.interp(self.e_ev, self.delta_real_energy, self.real_part)
        self.delta = np.interp(self.e_ev, self.delta_real_energy, deltas)
